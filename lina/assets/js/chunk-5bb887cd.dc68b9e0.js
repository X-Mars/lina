(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5bb887cd"],{"3cae":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.loading?e._e():a("GenericCreateUpdatePage",e._b({attrs:{"perform-submit":e.performSubmit,"create-success-next-route":e.createSuccessNextRoute}},"GenericCreateUpdatePage",e.$data,!1))},n=[],r=(a("1c01"),a("58b2"),a("8e6e"),a("d25f"),a("bd86")),o=(a("6762"),a("2fdb"),a("456d"),a("ac6a"),a("f3e2"),a("768b")),i=(a("6d67"),a("7f7f"),a("8ea5"),a("cd4a")),l=a("56f5"),c=a("cf45"),p=a("ce4b"),d=a("2f62"),u=a("4360");function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function f(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){Object(r["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var b={components:{GenericCreateUpdatePage:i["d"]},data:function(){var e,t=this,a=new Date,s=u["a"].getters.publicSettings["TICKET_AUTHORIZE_DEFAULT_TIME"],n=Object(c["g"])(s,new Date).toISOString(),r=a.toISOString();return{hasDetailInMsg:!1,loading:!0,initial:{ips_or_not:!0,apply_date_expired:n,apply_date_start:r,apply_actions:["all","connect","updownload","upload_file","download_file","clipboard_copy_paste","clipboard_copy","clipboard_paste"],apply_assets:[],org_id:"",type:"apply_asset"},fields:[[this.$t("common.Basic"),["title","type","org_id","comment"]],[this.$t("tickets.RequestPerm"),["apply_nodes","apply_assets","apply_system_users","apply_actions","apply_date_start","apply_date_expired"]]],fieldsMeta:{title:{el:{type:"input"}},type:{hidden:function(){return!0},el:{disabled:!0}},apply_actions:{label:this.$t("perms.Actions"),component:p["a"],helpText:this.$t("common.actionsTips")},apply_nodes:{label:this.$t("perms.Node"),component:l["a"],el:{value:[],ajax:{url:"",transformOption:function(e){return{label:"".concat(e.full_value),value:e.id}}},clearable:!0}},apply_assets:{type:"assetSelect",label:this.$t("perms.Asset"),component:l["a"],el:{value:[],ajax:{url:"",transformOption:function(e){return{label:e.hostname+"("+e.protocols+")",value:e.id}}}}},apply_system_users:{type:"systemUserSelect",component:l["a"],label:this.$t("assets.SystemUser"),el:{value:[],ajax:{url:"",transformOption:function(e){var t=e.username||"*";return{label:e.name+"("+t+")",value:e.id}}}}},org_id:{component:l["a"],el:{multiple:!1,options:null===(e=this.$store.state.users.noRootWorkbenchOrgs)||void 0===e?void 0:e.map((function(e){return{label:e.name,value:e.id}}))},hidden:function(e){var a=t.fieldsMeta;a.apply_system_users.el.ajax.url="/api/v1/assets/system-users/suggestions/?oid=".concat(e["org_id"],"&protocol__in=rdp,ssh,vnc,telnet"),a.apply_assets.el.ajax.url="/api/v1/assets/assets/suggestions/?oid=".concat(e["org_id"]),a.apply_nodes.el.ajax.url="/api/v1/assets/nodes/suggestions/?oid=".concat(e["org_id"])},on:{change:function(e,t){var a=Object(o["a"])(e,1);a[0];t({apply_nodes:[],apply_assets:[],apply_system_users:[]})}}}},cleanFormValue:function(e){return Object.keys(e).forEach((function(t,a,s){["apply_system_users","apply_assets","apply_nodes"].includes(t)&&e[t].length<1&&delete e[t]})),e},url:"/api/v1/tickets/apply-asset-tickets/?state=pending",createSuccessNextRoute:{name:"MyTicketList"}}},computed:f({},Object(d["c"])({workbenchOrgs:function(e){return e.users.noRootWorkbenchOrgs}}),{},Object(d["b"])(["currentOrg"])),mounted:function(){var e=this.currentOrg.id||"",t=this.workbenchOrgs.map((function(e){return e.id}))||[];t.includes(e)?this.initial.org_id=e:this.initial.org_id=t[0],this.loading=!1},methods:{performSubmit:function(e){return this.$axios["post"]("/api/v1/tickets/apply-asset-tickets/open/",e)}}},y=b,_=a("2877"),m=Object(_["a"])(y,s,n,!1,null,"63941d8c",null);t["default"]=m.exports},ce4b:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tree",e._b({attrs:{data:e.iData,"show-checkbox":"","node-key":"id","default-expand-all":!0,"default-checked-keys":e.value,props:e.defaultProps},on:{check:e.handleCheckChange}},"el-tree",e.$attrs,!1))},n=[],r=(a("6762"),a("2fdb"),a("ac4d"),a("8a81"),a("ac6a"),a("6d67"),{name:"PermissionFormActionField",props:{value:{type:Array,default:function(){return[]}},choices:{type:Array,default:function(){return[]}},actions:{type:Array,default:function(){return[]}}},data:function(){return{defaultProps:{children:"children",label:"label"},fullChoicesTreeNodes:[{id:"all",label:this.$t("perms.all"),children:[{id:"connect",label:this.$t("perms.connect")},{id:"updownload",label:this.$t("perms.upDownload"),children:[{id:"upload_file",label:this.$t("perms.uploadFile")},{id:"download_file",label:this.$t("perms.downloadFile")}]},{id:"clipboard_copy_paste",label:this.$t("perms.clipboardCopyPaste"),children:[{id:"clipboard_copy",label:this.$t("perms.clipboardCopy")},{id:"clipboard_paste",label:this.$t("perms.clipboardPaste")}]}]}]}},computed:{choicesIDs:function(){return 0!==this.actions.length?this.actions:0===this.choices.length?["all","connect","upload_file","download_file","updownload","clipboard_copy_paste","clipboard_copy","clipboard_paste"]:this.choices.map((function(e){return e.value}))},iData:function(){this.$log.debug("choices: ",this.choicesIDs);var e=_.cloneDeep(this.fullChoicesTreeNodes),t=this.trimChoicesTreeNodes(e);return this.$log.debug("choicesTreeNodes: ",t),t}},methods:{trimChoicesTreeNodes:function(e){var t=[],a=!0,s=!1,n=void 0;try{for(var r,o=e[Symbol.iterator]();!(a=(r=o.next()).done);a=!0){var i=r.value;if(this.choicesIDs.includes(i.id)){var l=i.children||[];0!==l.length&&(l=this.trimChoicesTreeNodes(l),i.children=l),t.push(i)}}}catch(c){s=!0,n=c}finally{try{a||null==o.return||o.return()}finally{if(s)throw n}}return t},handleCheckChange:function(e,t){var a=t.checkedKeys;0!==a.length&&a.push("connect"),this.$emit("input",a)}}}),o=r,i=a("2877"),l=Object(i["a"])(o,s,n,!1,null,"2d0b5919",null);t["a"]=l.exports}}]);