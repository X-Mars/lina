(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-70e37f81"],{2399:function(t,e,a){},"7e21":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.loading?t._e():a("GenericCreateUpdatePage",t._b({attrs:{"perform-submit":t.performSubmit,"create-success-next-route":t.createSuccessNextRoute}},"GenericCreateUpdatePage",t.$data,!1))},o=[],n=(a("1c01"),a("58b2"),a("8e6e"),a("f3e2"),a("d25f"),a("ac6a"),a("456d"),a("6762"),a("2fdb"),a("bd86")),p=(a("2caf"),a("6d67"),a("768b")),r=(a("7f7f"),a("8ea5"),a("cd4a")),c=a("56f5"),s=a("cf45"),l=a("7541"),u=a("cc0d"),d=a("ce4b"),y=a("2f62"),h=a("4360");function m(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function f(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?m(Object(a),!0).forEach((function(e){Object(n["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):m(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var _={components:{GenericCreateUpdatePage:r["d"]},data:function(){var t,e=this,a=this,i=new Date,o=h["a"].getters.publicSettings["TICKET_AUTHORIZE_DEFAULT_TIME"],n=Object(s["g"])(o,new Date).toISOString(),r=i.toISOString(),y=[];return{hasDetailInMsg:!1,loading:!0,initial:{ips_or_not:!0,apply_date_expired:n,apply_date_start:r,org_id:"",type:"apply_application"},fields:[[this.$t("common.Basic"),["title","type","org_id","comment"]],[this.$t("tickets.RequestPerm"),["apply_category_type","apply_applications","apply_system_users","apply_actions","apply_date_start","apply_date_expired"]]],fieldsMeta:{title:{el:{type:"input"}},type:{hidden:function(){return!0},el:{disabled:!0}},apply_actions:{label:this.$t("perms.Actions"),component:d["a"],helpText:this.$t("common.actionsTips"),el:{actions:["all","connect"]}},apply_applications:{type:"assetSelect",component:c["a"],label:this.$t("applications.App"),el:{value:[],ajax:{url:"",transformOption:function(t){return{label:t.name,value:t.id}}}}},apply_system_users:{type:"systemUserSelect",component:c["a"],label:this.$t("assets.SystemUser"),el:{value:[],ajax:{url:"",transformOption:function(t){if("k8s"===e.$route.query.type)return{label:t.name,value:t.id};var a=t.username||"*";return{label:t.name+"("+a+")",value:t.id}}}}},apply_category_type:{type:"cascader",label:this.$t("applications.appType"),rules:[l["c"]],el:{multiple:!1,options:u["b"]},on:{change:function(t,i){var o=Object(p["a"])(t,1),n=o[0];e.apply_category_type=n,i({apply_applications:[],apply_system_users:[]}),e.$axios.get("/api/v1/perms/application-permissions/applications/actions/?category=".concat(n[0])).then((function(t){e.fieldsMeta.apply_actions.el.actions=t})),e.fieldsMeta.apply_applications.el.ajax.url="/api/v1/applications/applications/suggestion/?oid=".concat(a.org_id,"&category=").concat(n[0],"&type=").concat(n[1]),e.fieldsMeta.apply_system_users.el.ajax.url="remote_app"===n[0]?"/api/v1/assets/system-users/suggestion/?oid=".concat(a.org_id,"&protocol=rdp"):"/api/v1/assets/system-users/suggestion/?oid=".concat(a.org_id,"&protocol=").concat(n[1])}}},apply_date_start:{label:this.$t("common.DateStart"),type:"date-picker",el:{type:"datetime"}},apply_date_expired:{label:this.$t("common.DateEnd"),type:"date-picker",el:{type:"datetime"}},org_id:{component:c["a"],el:{multiple:!1,options:null===(t=this.$store.state.users.noRootWorkbenchOrgs)||void 0===t?void 0:t.map((function(t){return{label:t.name,value:t.id}}))},hidden:function(t){e.org_id=t["org_id"],y=e.apply_category_type;var i=e.fieldsMeta;y&&(i.apply_applications.el.ajax.url="/api/v1/applications/applications/suggestions/?oid=".concat(a.org_id,"&category=").concat(y[0],"&type=").concat(y[1]),i.apply_system_users.el.ajax.url="remote_app"===y[0]?"/api/v1/assets/system-users/suggestions/?oid=".concat(a.org_id,"&protocol=rdp"):"/api/v1/assets/system-users/suggestions/?oid=".concat(a.org_id,"&protocol=").concat(y[1]))},on:{change:function(t,e){var a=Object(p["a"])(t,1);a[0];e({apply_applications:[],apply_system_users:[]})}}}},url:"/api/v1/tickets/apply-app-tickets/?state=pending",createSuccessNextRoute:{name:"MyTicketList"},cleanFormValue:function(t){var e=t.apply_applications,a=t.apply_system_users;return e&&Array.isArray(e)&&e.length<1&&delete t.apply_applications,a&&Array.isArray(a)&&a.length<1&&delete t.apply_system_users,t}}},computed:f({},Object(y["c"])({workbenchOrgs:function(t){return t.users.noRootWorkbenchOrgs}}),{},Object(y["b"])(["currentOrg"])),mounted:function(){var t=this.currentOrg.id||"",e=this.workbenchOrgs.map((function(t){return t.id}))||[];e.includes(t)?this.initial.org_id=t:this.initial.org_id=e[0],this.loading=!1},methods:{performSubmit:function(t){var e=t.apply_category_type,a=function(a,i){return e&&e.length>0?e[a]:t[i]};return t.apply_category=a(0,"apply_category"),t.apply_type=a(1,"apply_type"),delete t["apply_category_type"],this.$axios["post"]("/api/v1/tickets/apply-app-tickets/open/",t)}}},g=_,b=(a("a201"),a("2877")),v=Object(b["a"])(g,i,o,!1,null,"00353ea8",null);e["default"]=v.exports},a201:function(t,e,a){"use strict";var i=a("2399"),o=a.n(i);o.a},cc0d:function(t,e,a){"use strict";a.d(e,"h",(function(){return h})),a.d(e,"i",(function(){return b})),a.d(e,"g",(function(){return v})),a.d(e,"e",(function(){return O})),a.d(e,"f",(function(){return k})),a.d(e,"a",(function(){return T})),a.d(e,"d",(function(){return D})),a.d(e,"c",(function(){return S})),a.d(e,"b",(function(){return C}));var i=a("0692"),o=a("4360"),n=a("cf45"),p="chrome",r="mysql_workbench",c="vmware_client",s="custom",l="remote_app";function u(){return o["a"].getters.hasValidLicense}var d=[{name:p,title:i["a"].t("applications.applicationsType.".concat(p)),type:"primary",group:i["a"].t("applications.RemoteApp"),category:l,has:u},{name:r,title:i["a"].t("applications.applicationsType.".concat(r)),type:"primary",category:l,has:u},{name:c,title:i["a"].t("applications.applicationsType.".concat(c)),type:"primary",category:l,has:u},{name:s,title:i["a"].t("applications.applicationsType.".concat(s)),type:"primary",category:l,has:u}],y="mysql",h="oracle",m="postgresql",f="mariadb",_="db",g="sqlserver",b="redis",v="mongodb",O=[{name:y,title:i["a"].t("applications.applicationsType.".concat(y)),type:"primary",category:_,has:!0,group:i["a"].t("applications.RDBProtocol")},{name:f,title:i["a"].t("applications.applicationsType.".concat(f)),type:"primary",category:_,has:!0},{name:h,title:i["a"].t("applications.applicationsType.".concat(h)),type:"primary",category:_,has:u},{name:m,title:i["a"].t("applications.applicationsType.".concat(m)),type:"primary",category:_,has:u},{name:g,title:i["a"].t("applications.applicationsType.".concat(g)),type:"primary",category:_,has:u}],j={name:v,title:i["a"].t("applications.applicationsType.".concat(v)),type:"primary",category:_,group:i["a"].t("applications.NoSQLProtocol")},$={name:b,title:i["a"].t("applications.applicationsType.".concat(b)),type:"primary",category:_,has:!0},k=[j,$],T=[].concat(O,[j]),w="k8s",x="cloud",P=[{name:w,title:i["a"].t("applications.applicationsType.".concat(w)),group:i["a"].t("applications.Cloud"),type:"primary",category:x,has:!0}],D=[].concat(O,k,d,P),S=[].concat(O,k,P),C=[Object(n["j"])(O),Object(n["j"])(k),Object(n["j"])(d),Object(n["j"])(P)]},ce4b:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-tree",t._b({attrs:{data:t.iData,"show-checkbox":"","node-key":"id","default-expand-all":!0,"default-checked-keys":t.value,props:t.defaultProps},on:{check:t.handleCheckChange}},"el-tree",t.$attrs,!1))},o=[],n=(a("6762"),a("2fdb"),a("ac4d"),a("8a81"),a("ac6a"),a("6d67"),{name:"PermissionFormActionField",props:{value:{type:Array,default:function(){return[]}},choices:{type:Array,default:function(){return[]}},actions:{type:Array,default:function(){return[]}}},data:function(){return{defaultProps:{children:"children",label:"label"},fullChoicesTreeNodes:[{id:"all",label:this.$t("perms.all"),children:[{id:"connect",label:this.$t("perms.connect")},{id:"updownload",label:this.$t("perms.upDownload"),children:[{id:"upload_file",label:this.$t("perms.uploadFile")},{id:"download_file",label:this.$t("perms.downloadFile")}]},{id:"clipboard_copy_paste",label:this.$t("perms.clipboardCopyPaste"),children:[{id:"clipboard_copy",label:this.$t("perms.clipboardCopy")},{id:"clipboard_paste",label:this.$t("perms.clipboardPaste")}]}]}]}},computed:{choicesIDs:function(){return 0!==this.actions.length?this.actions:0===this.choices.length?["all","connect","upload_file","download_file","updownload","clipboard_copy_paste","clipboard_copy","clipboard_paste"]:this.choices.map((function(t){return t.value}))},iData:function(){this.$log.debug("choices: ",this.choicesIDs);var t=_.cloneDeep(this.fullChoicesTreeNodes),e=this.trimChoicesTreeNodes(t);return this.$log.debug("choicesTreeNodes: ",e),e}},methods:{trimChoicesTreeNodes:function(t){var e=[],a=!0,i=!1,o=void 0;try{for(var n,p=t[Symbol.iterator]();!(a=(n=p.next()).done);a=!0){var r=n.value;if(this.choicesIDs.includes(r.id)){var c=r.children||[];0!==c.length&&(c=this.trimChoicesTreeNodes(c),r.children=c),e.push(r)}}}catch(s){i=!0,o=s}finally{try{a||null==p.return||p.return()}finally{if(i)throw o}}return e},handleCheckChange:function(t,e){var a=e.checkedKeys;0!==a.length&&a.push("connect"),this.$emit("input",a)}}}),p=n,r=a("2877"),c=Object(r["a"])(p,i,o,!1,null,"2d0b5919",null);e["a"]=c.exports}}]);