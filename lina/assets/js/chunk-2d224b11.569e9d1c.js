(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d224b11"],{e0e5:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Page",t._b({},"Page",t.$attrs,!1),[t.showPasswordDialog?s("UserConfirmDialog",{attrs:{url:t.confirmUrl,visible:t.showPasswordDialog},on:{"update:visible":function(e){t.showPasswordDialog=e},UserConfirmDone:t.verifyDone,UserConfirmCancel:t.exit}}):t._e(),t._v(" "),s("div",[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{md:14,sm:24}},[s("DetailCard",{attrs:{items:t.detailCardItems}})],1),t._v(" "),s("el-col",{attrs:{md:10,sm:24}},[s("QuickActions",{attrs:{type:"primary",title:this.$t("users.AuthSettings"),actions:t.authQuickActions}}),t._v(" "),s("QuickActions",{staticStyle:{"margin-top":"15px"},attrs:{type:"info",title:this.$t("users.MessageSubscription"),fa:"fa-info-circle",actions:t.messageSubscriptionQuickActions}})],1)],1)],1)],1)},a=[],r=(s("ac4d"),s("8a81"),s("ac6a"),s("7f7f"),s("57e7"),s("d92a"),s("83b2")),c=s("b97b"),o=s("8c34"),n=s("a516"),l=s("cf45"),u=s("4360"),h={name:"ProfileInfo",components:{Page:r["a"],DetailCard:c["a"],QuickActions:o["a"],UserConfirmDialog:n["a"]},props:{object:{type:Object,default:function(){return u["a"].state.users.profile}}},data:function(){return{url:"/api/v1/users/profile/",showPasswordDialog:!1,currentEdit:"",authQuickActions:[{title:this.$t("users.setWeCom"),attrs:{type:"primary",label:this.$store.state.users.profile.is_wecom_bound?this.$t("common.unbind"):this.$t("common.bind")},has:this.$store.getters.publicSettings.AUTH_WECOM,callbacks:{click:function(){this.currentEdit="wecom",this.showPasswordDialog=!0}.bind(this)}},{title:this.$t("users.setDingTalk"),attrs:{type:"primary",label:this.$store.state.users.profile.is_dingtalk_bound?this.$t("common.unbind"):this.$t("common.bind")},has:this.$store.getters.publicSettings.AUTH_DINGTALK,callbacks:{click:function(){this.currentEdit="dingtalk",this.showPasswordDialog=!0}.bind(this)}},{title:this.$t("users.setFeiShu"),attrs:{type:"primary",label:this.$store.state.users.profile.is_feishu_bound?this.$t("common.unbind"):this.$t("common.bind")},has:this.$store.getters.publicSettings.AUTH_FEISHU,callbacks:{click:function(){this.currentEdit="feishu",this.showPasswordDialog=!0}.bind(this)}},{title:this.$t("users.SetMFA"),attrs:{type:"primary",label:this.$t("common.Setting")},callbacks:{click:function(){window.location.href="/core/auth/profile/mfa/"}}},{title:this.$t("users.UpdatePassword"),attrs:{type:"primary",label:this.$t("common.Update"),disabled:"local"!==this.$store.state.users.profile.source},callbacks:{click:function(){this.$router.push({name:"ProfileSetting",query:{activeTab:"PasswordUpdate"}})}.bind(this)}},{title:this.$t("users.UpdateSSHKey"),attrs:{type:"primary",label:this.$t("common.Update"),disabled:!this.$store.state.users.profile.can_public_key_auth},callbacks:{click:function(){this.$router.push({name:"ProfileSetting",query:{activeTab:"SSHUpdate"}})}.bind(this)}},{title:this.$t("users.ResetPublicKeyAndDownload"),attrs:{type:"primary",label:this.$t("common.Reset"),disabled:!this.$store.state.users.profile.can_public_key_auth},callbacks:{click:function(){window.open("/core/auth/profile/pubkey/generate/","_blank")}}}],messageSubscriptionQuickActions:[{title:this.$t("notifications.SiteMessage"),type:"switcher",attrs:{disabled:!0,name:"site_msg",model:-1!==this.object.receive_backends.indexOf("site_msg")},callbacks:{change:this.updateUserReceiveBackends}},{title:this.$t("setting.Email"),type:"switcher",attrs:{name:"email",model:-1!==this.object.receive_backends.indexOf("email")},callbacks:{change:this.updateUserReceiveBackends}},{title:this.$t("setting.WeCom"),type:"switcher",attrs:{name:"wecom",model:-1!==this.object.receive_backends.indexOf("wecom")},has:this.$store.getters.publicSettings.AUTH_WECOM,callbacks:{change:this.updateUserReceiveBackends}},{title:this.$t("setting.DingTalk"),type:"switcher",attrs:{name:"dingtalk",model:-1!==this.object.receive_backends.indexOf("dingtalk")},has:this.$store.getters.publicSettings.AUTH_DINGTALK,callbacks:{change:this.updateUserReceiveBackends}},{title:this.$t("setting.FeiShu"),type:"switcher",attrs:{name:"feishu",model:-1!==this.object.receive_backends.indexOf("feishu")},has:this.$store.getters.publicSettings.AUTH_FEISHU,callbacks:{change:this.updateUserReceiveBackends}}]}},computed:{detailCardItems:function(){var t=this.$createElement;return[{value:this.object.username,key:this.$t("users.Username")},{value:this.object.name,key:this.$t("users.Name")},{value:this.object.system_roles_display,key:this.$t("users.SystemRoles")},{value:this.object.org_roles_display,key:this.$t("users.OrgRoles")},{value:this.object.email,key:this.$t("users.Email")},{value:"".concat(this.object.is_active),key:this.$t("users.IsActive")},{value:this.object,key:"SSHKey",formatter:function(e,s){var i=s.public_key_comment,a=s.public_key_hash_md5;return t("span",[i," ",t("br")," ",a])}},{value:this.object.mfa_level_display,key:this.$t("users.MfaLevel")},{value:this.object.source_display,key:this.$t("users.Source")},{value:Object(l["q"])(this.object.date_joined),key:this.$t("users.DateJoined")},{value:Object(l["q"])(this.object.last_login),key:this.$t("users.DateLastLogin")},{value:Object(l["q"])(this.object.date_password_last_updated),key:this.$t("users.DatePasswordLastUpdated")},{value:Object(l["q"])(this.object.date_expired),key:this.$t("users.DateExpired")},{value:this.object.groups_display,key:this.$t("users.UserGroups")},{value:this.object.comment,key:this.$t("users.Comment")}]},confirmUrl:function(){return"/api/v1/authentication/confirm-oauth/"},bindOrUNBindUrl:function(){var t="";return t=this.object["is_".concat(this.currentEdit,"_bound")]?"/api/v1/authentication/".concat(this.currentEdit,"/qr/unbind/"):"/core/auth/".concat(this.currentEdit,"/qr/bind/?redirect_url=").concat(this.$route.fullPath),t}},methods:{updateUserReceiveBackends:function(t){var e=this;this.$axios.patch("/api/v1/notifications/user-msg-subscription/".concat(this.object.id,"/"),{receive_backends:this.getReceiveBackendList()}).then((function(t){e.$message.success(e.$t("common.updateSuccessMsg"))})).catch((function(t){e.$message.error(e.$t("common.updateErrorMsg "+t))}))},getReceiveBackendList:function(){var t=[],e=!0,s=!1,i=void 0;try{for(var a,r=this.messageSubscriptionQuickActions[Symbol.iterator]();!(e=(a=r.next()).done);e=!0){var c=a.value,o=c.attrs.name,n=c.attrs.model;n&&t.push(o)}}catch(l){s=!0,i=l}finally{try{e||null==r.return||r.return()}finally{if(s)throw i}}return t},verifyDone:function(){var t=this,e=this.bindOrUNBindUrl;this.object["is_".concat(this.currentEdit,"_bound")]?this.$axios.post(e).then((function(e){t.$message.success(t.$t("common.updateSuccessMsg")),t.$store.dispatch("users/getProfile")})):window.location.href=e,this.showPasswordDialog=!1},exit:function(){this.$emit("update:visible",!1)}}},d=h,b=s("2877"),m=Object(b["a"])(d,i,a,!1,null,"1f3c7572",null);e["default"]=m.exports}}]);